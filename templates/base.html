<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {# å„ãƒšãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒˆãƒ«ã¯ã“ã“ã§ãƒ–ãƒ­ãƒƒã‚¯ã¨ã—ã¦å®šç¾©ã—ã¦ãŠãã‚ˆï¼ #}
    <title>{% block title %}AIãŠå‹é”ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«{% endblock title %}</title>
    
    {# å…¨ã¦ã®ãƒšãƒ¼ã‚¸ã§å…±é€šã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã“ã“ã«æ›¸ãã‚ˆï¼ #}
    <style>
        body { font-family: sans-serif; margin: 0; background-color: #f0f8ff; display: flex; flex-direction: column; min-height: 100vh; color: #333; }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ (å¸¯ã®éƒ¨åˆ†) */
        .header {
            background-color: #337ab7; /* é’ç³» */
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex; /* æ¨ªä¸¦ã³ã«ã™ã‚‹ãŸã‚ã«flexboxã‚’ä½¿ã†ã‚ˆ */
            justify-content: space-between; /* ä¸¡ç«¯å¯„ã› */
            align-items: center; /* ä¸­å¤®æƒãˆ */
        }
        .header .logo {
            font-size: 1.8em;
            font-weight: bold;
            text-decoration: none;
            color: white;
        }
        .header .logo:hover {
            text-decoration: none; /* ãƒ›ãƒãƒ¼ã§ä¸‹ç·šãŒå‡ºãªã„ã‚ˆã†ã« */
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
        .header-nav {
            display: flex;
            align-items: center;
        }
        .header-nav a {
            color: white;
            text-decoration: none;
            font-weight: bold;
            margin-left: 20px; /* å„ãƒªãƒ³ã‚¯ã®é–“éš” */
            padding: 5px 0;
            transition: color 0.2s ease;
        }
        .header-nav a:hover {
            color: #d9edf7; /* ãƒ›ãƒãƒ¼ã§å°‘ã—æ˜ã‚‹ã */
        }
        .header-nav .logout-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            margin-left: 20px;
            padding: 5px 0;
            transition: color 0.2s ease;
        }
        .header-nav .logout-btn:hover {
            color: #d9edf7;
        }

        /* é€šçŸ¥ãƒãƒ¼ (ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸‹ã«è¡¨ç¤º) */
        .notification-bar {
            text-align: right;
            padding: 5px 10px;
            background-color: #e9f5e9; /* è–„ã„ç·‘ */
            border-bottom: 1px solid #c8e6c9;
            box-shadow: inset 0 -1px 3px rgba(0,0,0,0.05); /* å½±ã§å°‘ã—æµ®ãä¸ŠãŒã‚‰ã›ã‚‹ */
        }
        .notification-bar a {
            text-decoration: none;
            color: #388e3c; /* æ¿ƒã„ç·‘ */
            font-weight: bold;
            font-size: 0.9em;
        }
        .notification-bar .unread-count {
            background-color: red;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 0.7em;
            margin-left: 3px;
            display: inline-block;
            line-height: 1;
            min-width: 10px;
            text-align: center;
        }

        /* å„ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„éƒ¨åˆ†ã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
        .content-wrapper {
            flex-grow: 1; /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„éƒ¨åˆ†ãŒç¸¦æ–¹å‘ã«åºƒãŒã‚‹ã‚ˆã†ã« */
            padding: 20px;
            max-width: 900px; /* æœ€å¤§å¹…ã‚’è¨­å®š */
            margin: 20px auto; /* ä¸­å¤®å¯„ã› */
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        h1 { /* å„ãƒšãƒ¼ã‚¸ã®è¦‹å‡ºã— */
            text-align: center;
            color: #4CAF50;
            margin-bottom: 25px;
        }

        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º (Django messages frameworkç”¨) */
        .messages {
            list-style-type: none;
            padding: 0;
            margin: 0 0 20px 0;
        }
        .messages li {
            padding: 12px 20px;
            margin-bottom: 10px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            text-align: center;
            opacity: 0.95;
            transition: opacity 0.3s ease;
        }
        .messages li.success { background-color: #5cb85c; } /* ç·‘ */
        .messages li.info { background-color: #5bc0de; } /* æ°´è‰² */
        .messages li.warning { background-color: #f0ad4e; } /* ã‚ªãƒ¬ãƒ³ã‚¸ */
        .messages li.error { background-color: #d9534f; } /* èµ¤ */
        .messages li:hover { opacity: 1; } /* ãƒ›ãƒãƒ¼ã§é€æ˜åº¦ã‚’å…ƒã«æˆ»ã™ */


        /* ãƒ•ã‚©ãƒ¼ãƒ ã®å…±é€šã‚¹ã‚¿ã‚¤ãƒ« (æ±ç”¨çš„ãªã‚‚ã®) */
        form p { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="email"], input[type="password"], input[type="datetime-local"], textarea, select {
            width: calc(100% - 22px); /* paddingã¨borderã‚’è€ƒæ…® */
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box; /* ã“ã‚Œé‡è¦ï¼ */
        }
        textarea { resize: vertical; min-height: 80px; }
        .helptext { font-size: 0.8em; color: #777; margin-top: 2px; margin-bottom: 10px; display: block; }
        ul.errorlist { list-style-type: none; padding: 0; color: red; font-size: 0.9em; margin-top: -10px; margin-bottom: 10px; }
        button[type="submit"] {
            background-color: #5cb85c; color: white; padding: 10px 15px; border: none;
            border-radius: 4px; cursor: pointer; font-size: 1em; width: 100%;
            margin-top: 10px;
        }
        button[type="submit"]:hover { background-color: #4cae4c; }
        .cancel-link { text-align: center; margin-top: 15px; }
        .cancel-link a { color: #777; text-decoration: none; }
        .cancel-link a:hover { text-decoration: underline; }

        /* ãƒ•ãƒƒã‚¿ãƒ¼ */
        .footer {
            text-align: center;
            padding: 15px;
            margin-top: auto; /* ã“ã‚Œã§ãƒ•ãƒƒã‚¿ãƒ¼ãŒä¸€ç•ªä¸‹ã«å›ºå®šã•ã‚Œã‚‹ã‚ˆï¼ */
            color: #777;
            font-size: 0.9em;
            border-top: 1px solid #eee;
            background-color: #f8f8f8;
        }
    </style>
</head>
<body>
    {# å¸¯çŠ¶ã®ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ†ã ã‚ˆï¼ #}
    <header class="header">
        <a href="{% url 'main_app:top_page' %}" class="logo">AIãŠå‹é”ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</a>
        <nav class="header-nav">
            {% if user.is_authenticated %}
                <a href="{% url 'calendar_app:monthly_calendar_today' %}">ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</a>
                <a href="{% url 'accounts:friend_list' %}">ğŸ§‘â€ğŸ¤â€ğŸ§‘ å‹é”</a>
                <a href="{% url 'groups_app:group_list' %}">ğŸ‘¥ ã‚°ãƒ«ãƒ¼ãƒ—</a>
                <a href="{% url 'ai_assistant_app:ai_chat' 1 %}">ğŸ’¬ AIãƒãƒ£ãƒƒãƒˆ</a> {# AIã‚­ãƒ£ãƒ©ID=1(ã‚ã‚„)ã«ç›´è¡Œ #}
                <a href="{% url 'accounts:profile' %}">ğŸ‘¤ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</a>
                {# ãŠçŸ¥ã‚‰ã›ã¯é€šçŸ¥ãƒãƒ¼ã«ã‚‚ã‚ã‚‹ã‘ã©ã€ã“ã“ã«ã‚‚ãƒªãƒ³ã‚¯ã—ã¦ãŠãã¨åˆ†ã‹ã‚Šã‚„ã™ã„ã‹ã‚‚ #}
                <a href="{% url 'notifications_app:notification_list' %}">ğŸ”” ãŠçŸ¥ã‚‰ã›
                    {% if unread_notifications_count > 0 %}
                        <span class="unread-count">{{ unread_notifications_count }}</span>
                    {% endif %}
                </a>
                <form method="post" action="{% url 'accounts:logout' %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="logout-btn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
                </form>
            {% else %}
                <a href="{% url 'accounts:login' %}">ãƒ­ã‚°ã‚¤ãƒ³</a>
                <a href="{% url 'accounts:signup' %}">æ–°è¦ç™»éŒ²</a>
            {% endif %}
        </nav>
    </header>

    {# ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹å ´åˆã¯ã€é€šçŸ¥ãƒãƒ¼ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¸‹ã«è¡¨ç¤ºã™ã‚‹ã‚ˆï¼ #}
    {% if user.is_authenticated %}
        <div class="notification-bar">
            <a href="{% url 'notifications_app:notification_list' %}">
                <span role="img" aria-label="ãŠçŸ¥ã‚‰ã›">ğŸ””</span> ãŠçŸ¥ã‚‰ã›
                {% if unread_notifications_count > 0 %}
                    <span class="unread-count">{{ unread_notifications_count }}</span>
                {% else %}
                    <span style="font-size: 0.8em; color: #777;"> (0)</span>
                {% endif %}
            </a>
        </div>
    {% endif %}

    {# Django messages framework ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…±é€šã§è¡¨ç¤ºã™ã‚‹å ´æ‰€ #}
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>
                    {{ message }}
                </li>
            {% endfor %}
        </ul>
    {% endif %}

    {# å„ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ã€ã“ã“ã§ 'content-wrapper' ã¨ã„ã†ã‚¯ãƒ©ã‚¹ã§å›²ã‚€ã‚ˆï¼ #}
    {# ã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã®ä¸­ã«ã€å„ãƒšãƒ¼ã‚¸ã®å›ºæœ‰ã®HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå…¥ã‚‹ã‚ˆï¼ #}
    <div class="content-wrapper">
        {% block content %}
        {# ã“ã“ã«å„ãƒšãƒ¼ã‚¸ã®å€‹åˆ¥ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒæŒ¿å…¥ã•ã‚Œã‚‹ã‚ˆï¼ #}
        {% endblock content %}
    </div>

    {# å…¨ã¦ã®ãƒšãƒ¼ã‚¸ã§å…±é€šã®ãƒ•ãƒƒã‚¿ãƒ¼ã ã‚ˆï¼ #}
    <footer class="footer">
        Â© 2025 AIãŠå‹é”ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«. All rights reserved.
    </footer>
</body>
</html>